"use strict";(self.webpackChunkdesktop=self.webpackChunkdesktop||[]).push([[694],{2943:function(e,t,n){n(2791);t.Z=n.p+"static/media/plus.d7e440a9053b85ca748298a1f4aee1b2.svg"},2493:function(e,t,n){n.d(t,{D:function(){return a}});var i=n(184),a=function(){return(0,i.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,i.jsxs)("div",{className:"flex gap-1",children:[(0,i.jsx)("div",{className:"ball rounded-full w-[5px] h-[5px]"}),(0,i.jsx)("div",{className:"ball rounded-full w-[5px] h-[5px]"}),(0,i.jsx)("div",{className:"ball rounded-full w-[5px] h-[5px]"})]}),(0,i.jsx)("div",{className:"font-normal text-sm text-side-300",children:"typing..."})]})}},7905:function(e,t,n){n.d(t,{n:function(){return r}});var i=n(1925),a=n(3528),s=n(184),r=function(e){var t=e.img,n=e.is_online;return(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("img",{src:t?i.v+t:a,className:"w-12 h-12 rounded-full object-cover   ",alt:"avatar"}),n&&(0,s.jsx)("div",{className:"absolute w-3 h-3 bg-panel-200 rounded-full left-9 bottom-[1px]  border-[1px] stroke-[#1C1C23] shadow-lg "}),"    "]})}},4122:function(e,t,n){n.d(t,{C:function(){return a},T:function(){return s}});var i=n(4420),a=i.v9,s=function(){return(0,i.I0)()}},8694:function(e,t,n){n.r(t),n.d(t,{MessengerPage:function(){return G}});var i=n(3433),a=n(9439),s=n(3140),r=n(2791),l=n(4165),o=n(5861);var c=n.p+"static/media/divider.d256fd1020087c6f3d50b2e002f96f15.svg";var d=n.p+"static/media/search.019fe4aadcb66ac7d53a8efc6be0fa78.svg";var u=n.p+"static/media/call.b963b0f3c613f043a5ed1b8f581d8f5c.svg",f=n(7905),v=n(4122);var m=n.p+"static/media/trash.631884323fa182c88701f5e2481c3521.svg",x=n(1457),h=n(184),p=function(e){var t,n,i,p,g,b,j=e.chat,N=(0,v.C)((function(e){return e.auth})),w=(0,s.s0)(),y=localStorage.getItem("access"),S=(0,r.useState)(),k=(0,a.Z)(S,2),C=k[0],E=k[1];(0,r.useEffect)((function(){var e,t;return function n(){(e=new WebSocket("ws://192.168.1.5:8000/ws/users/test?token=".concat(y))).onopen=function(){clearInterval(t)},e.onmessage=function(e){var t=JSON.parse(e.data);E(null===t||void 0===t?void 0:t.contacts)},e.onclose=function(){t=setTimeout(n,3e3)}}(),function(){e&&e.close()}}),[y]);var A=function(){var e,t,n=null===j||void 0===j||null===(e=j.users)||void 0===e||null===(t=e.find((function(e){return e.id!==N.id})))||void 0===t?void 0:t.id;if(!n)throw new Error("Partner user not found");return null===C||void 0===C?void 0:C.find((function(e){return e.id===n}))}(),I=function(){var e=(0,o.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x.O.deleteChatById(t);case 2:204===e.sent.status&&w("/");case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return(0,h.jsxs)("div",{id:"header-message",className:"flex justify-between pl-6 pr-6 items-center h-[8%] bg-[#353540]/50 backdrop-blur-md",children:[(0,h.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,h.jsx)(f.n,{img:null!==(t=null===A||void 0===A||null===(n=A.profile)||void 0===n||null===(i=n.avatar)||void 0===i||null===(p=i[A.profile.avatar.length-1])||void 0===p?void 0:p.image)&&void 0!==t?t:""}),(0,h.jsxs)("div",{children:[(0,h.jsxs)("div",{className:"text-[#fff] font-normal",children:[null===A||void 0===A||null===(g=A.profile)||void 0===g?void 0:g.name," ",null===A||void 0===A||null===(b=A.profile)||void 0===b?void 0:b.surname]}),(0,h.jsx)("div",{className:"text-[#1C92B5] font-normal",children:null!==A&&void 0!==A&&A.is_online?"Online":"Offline"})]})]}),(0,h.jsxs)("div",{className:"flex gap-4 items-center relative",children:[(0,h.jsx)("img",{className:"h-5 cursor-pointer",src:u,alt:"Call"}),(0,h.jsx)("img",{className:"h-5 cursor-pointer",src:d,alt:"Search"}),(0,h.jsx)("img",{className:"h-5 cursor-pointer",src:c,alt:"Divider"}),(0,h.jsx)("img",{className:" h-5 cursor-pointer ",src:m,alt:"trash",onClick:function(){return I(j.id)}})]})]})},g=n(7462),b=n(3366),j=r.useLayoutEffect,N=function(e,t){"function"!==typeof e?e.current=t:e(t)},w={"min-height":"0","max-height":"none",height:"0",visibility:"hidden",overflow:"hidden",position:"absolute","z-index":"-1000",top:"0",right:"0",display:"block"},y=function(e){Object.keys(w).forEach((function(t){e.style.setProperty(t,w[t],"important")}))},S=null,k=function(e,t){var n=e.scrollHeight;return"border-box"===t.sizingStyle.boxSizing?n+t.borderSize:n-t.paddingSize};var C=function(){},E=["borderBottomWidth","borderLeftWidth","borderRightWidth","borderTopWidth","boxSizing","fontFamily","fontSize","fontStyle","fontWeight","letterSpacing","lineHeight","paddingBottom","paddingLeft","paddingRight","paddingTop","tabSize","textIndent","textRendering","textTransform","width","wordBreak","wordSpacing","scrollbarGutter"],A=!!document.documentElement.currentStyle,I=function(e){var t=window.getComputedStyle(e);if(null===t)return null;var n,i=(n=t,E.reduce((function(e,t){return e[t]=n[t],e}),{})),a=i.boxSizing;return""===a?null:(A&&"border-box"===a&&(i.width=parseFloat(i.width)+parseFloat(i.borderRightWidth)+parseFloat(i.borderLeftWidth)+parseFloat(i.paddingRight)+parseFloat(i.paddingLeft)+"px"),{sizingStyle:i,paddingSize:parseFloat(i.paddingBottom)+parseFloat(i.paddingTop),borderSize:parseFloat(i.borderBottomWidth)+parseFloat(i.borderTopWidth)})};function T(e,t,n){var i=function(e){var t=r.useRef(e);return j((function(){t.current=e})),t}(n);r.useLayoutEffect((function(){var n=function(e){return i.current(e)};if(e)return e.addEventListener(t,n),function(){return e.removeEventListener(t,n)}}),[])}var z=["cacheMeasurements","maxRows","minRows","onChange","onHeightChange"],R=function(e,t){var n=e.cacheMeasurements,i=e.maxRows,a=e.minRows,s=e.onChange,l=void 0===s?C:s,o=e.onHeightChange,c=void 0===o?C:o,d=(0,b.Z)(e,z),u=void 0!==d.value,f=r.useRef(null),v=function(e,t){var n=r.useRef();return r.useCallback((function(i){e.current=i,n.current&&N(n.current,null),n.current=t,t&&N(t,i)}),[t])}(f,t),m=r.useRef(0),x=r.useRef(),h=function(){var e=f.current,t=n&&x.current?x.current:I(e);if(t){x.current=t;var s=function(e,t,n,i){void 0===n&&(n=1),void 0===i&&(i=1/0),S||((S=document.createElement("textarea")).setAttribute("tabindex","-1"),S.setAttribute("aria-hidden","true"),y(S)),null===S.parentNode&&document.body.appendChild(S);var a=e.paddingSize,s=e.borderSize,r=e.sizingStyle,l=r.boxSizing;Object.keys(r).forEach((function(e){var t=e;S.style[t]=r[t]})),y(S),S.value=t;var o=k(S,e);S.value=t,o=k(S,e),S.value="x";var c=S.scrollHeight-a,d=c*n;"border-box"===l&&(d=d+a+s),o=Math.max(d,o);var u=c*i;return"border-box"===l&&(u=u+a+s),[o=Math.min(u,o),c]}(t,e.value||e.placeholder||"x",a,i),r=s[0],l=s[1];m.current!==r&&(m.current=r,e.style.setProperty("height",r+"px","important"),c(r,{rowHeight:l}))}};return r.useLayoutEffect(h),function(e,t){T(document.body,"reset",(function(n){e.current.form===n.target&&t(n)}))}(f,(function(){if(!u){var e=f.current,t=e.value;requestAnimationFrame((function(){t!==e.value&&h()}))}})),T(window,"resize",h),function(e){T(document.fonts,"loadingdone",e)}(h),r.createElement("textarea",(0,g.Z)({},d,{onChange:function(e){u||h(),l(e)},ref:v}))},D=r.forwardRef(R);var F=n.p+"static/media/send.95659bab2baafdb2c8eaa6041369d0fc.svg",M=n(2493),Z=function(e){var t=e.sendMessage,n=e.setMyMessage,i=e.myMessage,a=e.chat,s=(e.IsTyping,e.setIsTyping),l=(0,v.C)((function(e){return e.auth}));(0,r.useEffect)((function(){if(i){s({id:a.id,status:!0});var e=setTimeout((function(){s({id:a.id,status:!1})}),3e3);return function(){return clearTimeout(e)}}s({id:a.id,status:!1})}),[i]);return(0,h.jsxs)("div",{children:[(0,h.jsx)("div",{className:"p-4 pl-16 scale-110",children:function(){var e,t=null===a||void 0===a||null===(e=a.typed)||void 0===e?void 0:e.filter((function(e){return e!=l.id}));return!!(t&&t.length>=1)}()&&(0,h.jsx)(M.D,{})}),(0,h.jsxs)("div",{className:"flex items-center p-2  bg-transparent relative",children:[(0,h.jsx)(D,{minRows:1,maxRows:5,value:i,onChange:function(e){return n(e.target.value)},placeholder:"Type a message...",className:"text-[#fff] font-normal relative flex-1 p-4 bg-side-200  rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 resize-none overflow-y-auto",onKeyDown:function(e){"Enter"!==e.key||e.shiftKey||(e.preventDefault(),t())}}),(0,h.jsx)("div",{onClick:t,className:"absolute flex justify-center items-center right-4 bottom-6 cursor-pointer  ",children:(0,h.jsx)("img",{src:F,alt:"send icon",className:"scale-110"})})]})]})},O=function(e){var t,n,i,a,s,r,l,o=e.msg,c=(0,v.C)((function(e){return e.auth}));return(0,h.jsxs)(h.Fragment,{children:[c.id!==o.owner.id&&(0,h.jsxs)("div",{className:"flex gap-4",children:[(0,h.jsx)("div",{className:"scale-110",children:(0,h.jsx)(f.n,{img:null===(t=o.owner.profile)||void 0===t||null===(n=t.avatar[o.owner.profile.avatar.length-1])||void 0===n?void 0:n.image})}),(0,h.jsxs)("div",{className:"flex flex-col gap-1 w-fit max-w-[60%] ",children:[(0,h.jsxs)("div",{className:" flex justify-between gap-6 items-center pr-4",children:[(0,h.jsxs)("div",{className:"text-[#fff] font-normal",children:[null===(i=o.owner.profile)||void 0===i?void 0:i.name," ",null===(a=o.owner.profile)||void 0===a?void 0:a.surname]}),(0,h.jsx)("div",{className:"text-side-300 font-normal text-sm",children:(null===o||void 0===o?void 0:o.create_at)&&new Intl.DateTimeFormat("uk-UA",{hour:"2-digit",minute:"2-digit"}).format(new Date(null===o||void 0===o?void 0:o.create_at))})]}),(0,h.jsx)("div",{className:"relative pl-6 pr-6 pt-4 pb-4 w-fit  bg-[#1E1E25] rounded-3xl rounded-tl-none text-[#fff] font-normal",children:o.content})]})]}),c.id===o.owner.id&&(0,h.jsx)("div",{className:"w-full flex justify-end",children:(0,h.jsxs)("div",{className:"flex flex-col gap-2 w-fit max-w-[60%]",children:[(0,h.jsxs)("div",{className:"flex justify-end gap-2 items-end",children:[(0,h.jsx)("div",{className:"text-[#fff] font-normal",children:" "}),(0,h.jsxs)("div",{className:"text-side-300 font-normal",children:[" ",(null===o||void 0===o?void 0:o.create_at)&&new Intl.DateTimeFormat("uk-UA",{hour:"2-digit",minute:"2-digit"}).format(new Date(null===o||void 0===o?void 0:o.create_at))]}),(0,h.jsx)("div",{className:"scale-90",children:(0,h.jsx)(f.n,{img:null===(s=c.profile)||void 0===s||null===(r=s.avatar[(null===(l=c.profile)||void 0===l?void 0:l.avatar.length)-1])||void 0===r?void 0:r.image})})]}),(0,h.jsx)("div",{children:(0,h.jsx)("div",{className:"relative pl-6 pr-6 pt-4 pb-4   gradient    rounded-3xl rounded-tr-none text-[#fff] font-normal",children:o.content})})]})})]})},W=function(e){var t=e.chat,n=e.IsTyping,i=e.setIsTyping,s=(0,r.useState)(null),l=(0,a.Z)(s,2),o=l[0],c=l[1],d=localStorage.getItem("access"),u=(0,r.useState)(""),f=(0,a.Z)(u,2),v=f[0],m=f[1],x=(0,r.useState)(),g=(0,a.Z)(x,2),b=g[0],j=g[1];(0,r.useEffect)((function(){var e=null;return e&&e.close(),(e=new WebSocket("ws://192.168.1.5:8000/ws/chat/".concat(t.id,"/messages?token=").concat(d))).onopen=function(){},e.onmessage=function(e){var t=JSON.parse(e.data);j(t)},e.onclose=function(){},c(e),function(){e&&e.close()}}),[t.id,d]);var N=(0,r.useRef)(null);return(0,r.useEffect)((function(){N.current&&N.current.scrollIntoView({behavior:"smooth"})}),[b]),(0,h.jsxs)("div",{className:"w-[55%] h-full flex flex-col justify-between bg-side-100",children:[(0,h.jsx)(p,{chat:t}),(0,h.jsx)("div",{className:"flex-1 flex flex-col overflow-y-auto",ref:N,children:(0,h.jsxs)("div",{className:"flex flex-col gap-2 p-6",children:[null===b||void 0===b?void 0:b.map((function(e){return(0,h.jsx)("div",{className:"pt-3 pb-3",children:(0,h.jsx)(O,{msg:e})},e.id)})),(0,h.jsx)("div",{ref:N})]})}),(0,h.jsx)(Z,{setIsTyping:i,IsTyping:n,chat:t,sendMessage:function(){v.trim()&&o&&(o.send(JSON.stringify({chat:t.id,content:v})),m(""))},setMyMessage:m,myMessage:v})]})};var L=n.p+"static/media/menu.d823f8b5b1eefbe3161e1ce65b78d2ca.svg";var B=n.p+"static/media/copy.30eedaf7a10619357f8e7cce1d379176.svg";var P=n.p+"static/media/notificationOff.8d612baade8a395df85e57f780f8535e.svg";var _=n.p+"static/media/meddia.d363b16cb751c017cbaa4c55a7d926ad.svg",H=n(2943);var J=n.p+"static/media/member.36a47a19ba9af437b2228151f956ea3b.svg",U=function(e){var t=e.image,n=e.name;return(0,h.jsx)("div",{className:"flex justify-between items-center ",children:(0,h.jsxs)("div",{className:"flex items-center gap-2",children:[(0,h.jsx)("div",{className:"scale-90",children:(0,h.jsx)(f.n,{img:t})}),(0,h.jsx)("div",{className:"text-[#fff] font-normal text-lg",children:n})]})})},K=n(1925),V=n(3528),q=function(e){var t,n,i,a,s,r,l,o,c,d,u,f,m,x,p=e.chat,g=(0,v.C)((function(e){return e.auth})),b=function(){var e,t=null===p||void 0===p||null===(e=p.users)||void 0===e?void 0:e.find((function(e){return e.id!==g.id}));if(!t)throw new Error("Partner user not found");return t}(),j=null===(t=b.profile)||void 0===t||null===(n=t.avatar)||void 0===n||null===(i=n[b.profile.avatar.length-1])||void 0===i?void 0:i.image;return(0,h.jsxs)("div",{className:"flex flex-col flex-1 h-full bg-side-100 p-4 border-l border-[#353540]",children:[(0,h.jsxs)("div",{className:"flex gap-2 p-4 items-center",children:[(0,h.jsx)("img",{src:L,className:"cursor-pointer"}),(0,h.jsx)("div",{className:"text-[#fff] font-medium text-lg",children:"Chat Info"})]}),(0,h.jsx)("div",{className:"p-4 ",children:(0,h.jsx)("div",{className:"bg-side-300 h-[1px] w-full"})}),(0,h.jsxs)("div",{className:"flex flex-col items-center gap-2",children:[(0,h.jsx)("img",{src:j?K.v+j:V,className:"rounded-full object-cover w-28 h-28",alt:"Partner Avatar"}),(0,h.jsx)("div",{className:"font-normal text-[#fff] text-lg pt-2",children:null===(a=b.profile)||void 0===a?void 0:a.name}),(0,h.jsx)("div",{className:"text-[#A1A1A1] font-light text-base",children:"2 Members"})]}),(0,h.jsxs)("div",{className:"flex flex-col gap-2 p-4",children:[(0,h.jsx)("div",{className:"text-[#fff] font-normal",children:"Bio"}),(0,h.jsx)("div",{className:"text-[#A1A1A1] font-light",children:null!==(s=null===(r=b.profile)||void 0===r?void 0:r.bio)&&void 0!==s?s:"No bio available"}),(0,h.jsxs)("div",{className:"flex justify-between items-center pt-4",children:[(0,h.jsx)("p",{className:"font-medium ",children:b.nickname}),(0,h.jsx)("img",{src:B})]})]}),(0,h.jsx)("div",{className:"p-4 ",children:(0,h.jsx)("div",{className:"bg-side-300 h-[1px] w-full"})}),(0,h.jsxs)("div",{className:"flex justify-between items-center p-4",children:[(0,h.jsx)("div",{className:"text-[#fff] font-normal",children:"Notification"}),(0,h.jsxs)("div",{className:"flex gap-2 cursor-pointer",children:[(0,h.jsx)("div",{className:"font-light text-[#a1a1a1]  ",children:"Off"}),(0,h.jsx)("img",{src:P,className:""})]})]}),(0,h.jsx)("div",{className:"p-4 ",children:(0,h.jsx)("div",{className:"bg-side-300 h-[1px] w-full"})}),(0,h.jsx)("div",{className:"flex flex-col p-4 gap-2",children:(0,h.jsxs)("div",{className:"flex gap-2 justify-between items-center",children:[(0,h.jsxs)("div",{className:"flex gap-2",children:[(0,h.jsx)("img",{src:_}),(0,h.jsx)("div",{className:"text-[#fff] font-normal",children:"Shared Media "})]}),(0,h.jsx)("span",{className:"font-light",children:"(0 Items)"})]})}),(0,h.jsx)("div",{className:"p-4 ",children:(0,h.jsxs)("div",{className:" flex bg-side-200 rounded-full p-2 ",children:[(0,h.jsx)("button",{className:"text-[#fff]  font-light text-base rounded-full flex-1  outline-none hover:bg-gradient-to-r from-[#108DA6] to-[#47A4ED] p-2 ",children:"Photos"}),(0,h.jsx)("button",{className:"text-[#fff]  font-light text-base rounded-full flex-1  outline-none hover:bg-gradient-to-r from-[#108DA6] to-[#47A4ED] p-2 ",children:"File"}),(0,h.jsx)("button",{className:"text-[#fff]  font-light text-base rounded-full flex-1  outline-none hover:bg-gradient-to-r from-[#108DA6] to-[#47A4ED] p-2 ",children:"Video"}),(0,h.jsx)("button",{className:"text-[#fff]  font-light text-base rounded-full flex-1  outline-none hover:bg-gradient-to-r from-[#108DA6] to-[#47A4ED] p-2 ",children:"Link"})]})}),(0,h.jsxs)("div",{className:"flex justify-between items-center p-4",children:[(0,h.jsxs)("div",{className:"flex  items-center gap-2",children:[(0,h.jsx)("img",{src:J}),(0,h.jsxs)("div",{className:"text-[#fff] font-normal",children:["Members ",(0,h.jsx)("span",{className:"font-light",children:"(2)"})]})]}),(0,h.jsx)("img",{src:H.Z,className:"size-6"})]}),(0,h.jsxs)("div",{className:"p-4 flex flex-col gap-3 overflow-y-auto h-100vh",children:[(0,h.jsx)(U,{image:null===(l=b.profile)||void 0===l||null===(o=l.avatar)||void 0===o||null===(c=o[b.profile.avatar.length-1])||void 0===c?void 0:c.image,name:null===(d=b.profile)||void 0===d?void 0:d.name}),(0,h.jsx)(U,{image:null===(u=g.profile)||void 0===u||null===(f=u.avatar)||void 0===f||null===(m=f[g.profile.avatar.length-1])||void 0===m?void 0:m.image,name:null===(x=g.profile)||void 0===x?void 0:x.name})]})]})},G=function(){var e=(0,s.UO)().id,t=(0,r.useState)(null),n=(0,a.Z)(t,2),l=n[0],o=n[1],c=(0,r.useState)(),d=(0,a.Z)(c,2),u=d[0],f=d[1],m=(0,r.useState)(null),x=(0,a.Z)(m,2),p=x[0],g=x[1],b=(0,v.C)((function(e){return e.auth})),j=localStorage.getItem("access");(0,r.useEffect)((function(){var t=null;return t&&t.close(),(t=new WebSocket("ws://192.168.1.5:8000/ws/chat/me/".concat(e,"?token=").concat(j))).onopen=function(){},t.onmessage=function(e){var t=JSON.parse(e.data);g(t)},t.onclose=function(){},o(t),function(){t&&t.close()}}),[e,j]);var N=function(){return p?null!==u&&void 0!==u&&u.status?(Array.isArray(p.typed)||(p.typed=[]),p.typed.includes(b.id)?p.typed:[].concat((0,i.Z)(p.typed),[b.id])):(null===(e=p.typed)||void 0===e?void 0:e.filter((function(e){return e!==b.id})))||[]:[];var e};return(0,r.useEffect)((function(){u&&l&&l.send(JSON.stringify({chat:e,users:N()}))}),[u]),(0,h.jsx)(h.Fragment,{children:p&&(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(W,{chat:p,setIsTyping:f,IsTyping:u}),(0,h.jsx)(q,{chat:p})]})})}},3528:function(e,t,n){e.exports=n.p+"static/media/bg_user.dace0770b43f04832c50.webp"}}]);
//# sourceMappingURL=694.91c8ecb5.chunk.js.map